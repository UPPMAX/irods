ListInfectedObjsInColl||msiAddSelectFieldToGenQuery(DATA_NAME,null,*GenQInp)##msiAddConditionToGenQuery(COLL_NAME,"=",*collection,*GenQInp)##msiAddConditionToGenQuery(META_DATA_ATTR_NAME,"like","INFECTED%",*GenQInp)##msiExecGenQuery(*GenQInp,*GenQOut)##forEachExec(*GenQOut,msiGetValByKey(*GenQOut,"DATA_NAME",*dataName)##writeLine(stdout,"*collection/*dataName"),nop##nop)##msiAddSelectFieldToGenQuery(DATA_NAME,null,*GenQInp1)##msiAddSelectFieldToGenQuery(COLL_NAME,null,*GenQInp1)##msiAddConditionToGenQuery(COLL_NAME,"like","*collection/%",*GenQInp1)##msiAddConditionToGenQuery(META_DATA_ATTR_NAME,"like","INFECTED%",*GenQInp1)##msiExecGenQuery(*GenQInp1,*GenQOut1)##forEachExec(*GenQOut1,msiGetValByKey(*GenQOut1,"DATA_NAME",*dataName)##msiGetValByKey(*GenQOut1,"COLL_NAME",*collName)##writeLine(stdout,"*collName/*dataName"),nop##nop##nop)|nop
*collection=$1
ruleExecOut
