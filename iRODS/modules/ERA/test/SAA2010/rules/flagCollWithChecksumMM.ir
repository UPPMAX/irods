flagCollWithChecksumMM||msiAddSelectFieldToGenQuery(DATA_ID,COUNT,*GenQInp)##msiAddConditionToGenQuery(COLL_NAME,"=",*collection,*GenQInp)##msiAddConditionToGenQuery(META_DATA_ATTR_NAME,"like","CHECKSUM_MISMATCH%",*GenQInp)##msiExecGenQuery(*GenQInp,*GenQOut)##forEachExec(*GenQOut,msiGetValByKey(*GenQOut,"DATA_ID",*objCount),nop)##msiAddSelectFieldToGenQuery(DATA_ID,COUNT,*GenQInp1)##msiAddConditionToGenQuery(COLL_NAME,"like","*collection/%",*GenQInp1)##msiAddConditionToGenQuery(META_DATA_ATTR_NAME,"like","CHECKSUM_MISMATCH%",*GenQInp1)##msiExecGenQuery(*GenQInp1,*GenQOut1)##forEachExec(*GenQOut1,msiGetValByKey(*GenQOut1,"DATA_ID",*objCount1),nop)##assign(*count,"*objCount + *objCount1")##ifExec(*count > 0,msiGetSystemTime(*Time,human)##msiAddKeyVal(*KVP,"CHECKSUM_MISMATCH.*Time",*count)##msiAssociateKeyValuePairsToObj(*KVP,*collection,"-C"),nop##nop##nop,nop,nop)##writeLine(stdout,*count)|nop##nop##nop##nop##nop##nop##nop##nop##nop##nop##nop##nop##nop##nop
*collection=$1
ruleExecOut
